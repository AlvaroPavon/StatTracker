= Informe de Pruebas de Sistema
:toc:
:toc-title: Contenido
:icons: font
:source-highlighter: rouge
:numbered:

== Información General

*Proyecto*: StatTracker +
*Fecha de pruebas*: Enero 2025 +
*Tipo de pruebas*: Pruebas de Sistema / End-to-End (E2E) +
*Entorno*: Entorno de desarrollo/staging +
*Herramientas*: Navegador web, pruebas manuales y automatizadas

== Objetivos de las Pruebas de Sistema

Las pruebas de sistema tienen como objetivo validar que:

. El sistema funciona correctamente como un todo integrado
. Los flujos de usuario completos funcionan según lo esperado
. La interfaz de usuario se comporta correctamente
. La integración entre frontend, backend y base de datos es correcta
. El sistema cumple con los requisitos funcionales especificados

== Alcance de las Pruebas

=== Funcionalidades Cubiertas

* ✓ Registro de nuevos usuarios
* ✓ Inicio de sesión
* ✓ Gestión de perfil de usuario
* ✓ Cambio de contraseña
* ✓ Registro de métricas de salud
* ✓ Visualización de historial
* ✓ Eliminación de registros
* ✓ Cierre de sesión

=== Funcionalidades NO Cubiertas

* Recuperación de contraseña (no implementada)
* Notificaciones (no implementadas)
* Exportación de datos (no implementada)

== Metodología de Pruebas

=== Enfoque

Se utilizó un enfoque mixto:

. *Pruebas Manuales Exploratorias*: Para identificar problemas de usabilidad y comportamiento
. *Pruebas Automatizadas* (Recomendado): Usar Playwright/Selenium para automatizar flujos críticos

=== Criterios de Aceptación

Cada caso de prueba debe cumplir:

* El flujo completa sin errores
* Los datos se persisten correctamente en la base de datos
* Los mensajes de éxito/error son claros
* La interfaz responde adecuadamente
* No hay errores en la consola del navegador

== Casos de Prueba Ejecutados

=== TC-001: Flujo Completo de Registro de Usuario

*Objetivo*: Verificar que un nuevo usuario puede registrarse exitosamente

*Pasos*:
. Acceder a la página principal
. Hacer clic en "Registrarse"
. Completar formulario:
   * Nombre: "Juan"
   * Apellidos: "Pérez García"
   * Email: "juan.perez@example.com"
   * Contraseña: "Password123!"
   * Confirmar contraseña: "Password123!"
. Hacer clic en "Registrarse"

*Resultado Esperado*:
* El usuario se registra correctamente
* Redirección a la página de login
* Mensaje de éxito visible
* Usuario existe en la base de datos

*Resultado Obtenido*: ✅ PASS

*Observaciones*: El flujo funciona correctamente. El usuario puede inmediatamente iniciar sesión con las credenciales creadas.

=== TC-002: Validación de Registro con Email Duplicado

*Objetivo*: Verificar que no se pueden registrar emails duplicados

*Pasos*:
. Intentar registrar un usuario con email ya existente
. Observar mensaje de error

*Resultado Esperado*:
* Mensaje de error: "El email ya está registrado"
* El formulario permanece visible
* No se crea usuario duplicado en BD

*Resultado Obtenido*: ✅ PASS

*Observaciones*: La validación funciona correctamente tanto en backend como frontend.

=== TC-003: Validación de Formato de Email

*Objetivo*: Verificar que se valida el formato del email

*Precondiciones*: En página de registro

*Pasos*:
. Introducir email inválido: "correo-invalido"
. Intentar registrarse

*Resultado Esperado*:
* Mensaje de error: "Formato de email inválido"
* No se crea el usuario

*Resultado Obtenido*: ✅ PASS

=== TC-004: Inicio de Sesión Exitoso

*Objetivo*: Verificar que un usuario registrado puede iniciar sesión

*Precondiciones*: Usuario registrado en el sistema

*Pasos*:
. Acceder a la página de login
. Introducir email válido
. Introducir contraseña correcta
. Hacer clic en "Iniciar Sesión"

*Resultado Esperado*:
* Redirección al dashboard
* Mensaje de bienvenida visible con nombre del usuario
* Sesión activa

*Resultado Obtenido*: ✅ PASS

*Observaciones*: El dashboard carga correctamente con todos los elementos visibles.

=== TC-005: Inicio de Sesión con Credenciales Incorrectas

*Objetivo*: Verificar el manejo de credenciales incorrectas

*Pasos*:
. Intentar login con email válido pero contraseña incorrecta
. Intentar login con email no existente

*Resultado Esperado*:
* Mensaje de error: "Email o contraseña incorrectos"
* No se inicia sesión
* El usuario permanece en la página de login

*Resultado Obtenido*: ✅ PASS

*Observaciones*: El mensaje es genérico para prevenir enumeración de usuarios (buena práctica de seguridad).

=== TC-006: Añadir Métrica de Salud

*Objetivo*: Verificar que se pueden añadir métricas correctamente

*Precondiciones*: Usuario autenticado en dashboard

*Pasos*:
. Completar formulario de datos de salud:
   * Peso: 75.5
   * Altura: 1.75
   * Fecha: 2025-01-15
. Hacer clic en "Añadir Datos"

*Resultado Esperado*:
* Mensaje de éxito
* El registro aparece inmediatamente en la tabla
* El IMC se calcula correctamente: 24.65
* Los datos se guardan en la base de datos

*Resultado Obtenido*: ✅ PASS

*Observaciones*: 
* El IMC se calcula y muestra correctamente (75.5 / (1.75)² = 24.65)
* La tabla se actualiza sin necesidad de recargar la página

=== TC-007: Validación de Altura Cero

*Objetivo*: Verificar que se previene la división por cero

*Precondiciones*: Usuario en dashboard

*Pasos*:
. Introducir peso: 70
. Introducir altura: 0
. Intentar añadir datos

*Resultado Esperado*:
* Mensaje de error: "La altura no puede ser cero"
* No se guardan los datos

*Resultado Obtenido*: ✅ PASS

*Observaciones*: La validación previene errores de cálculo.

=== TC-008: Visualización de Historial Ordenado

*Objetivo*: Verificar que el historial se muestra ordenado por fecha

*Precondiciones*: 
* Usuario autenticado
* Múltiples registros con diferentes fechas

*Pasos*:
. Añadir registro con fecha: 2025-01-01
. Añadir registro con fecha: 2025-01-15
. Añadir registro con fecha: 2025-01-08
. Observar orden en la tabla

*Resultado Esperado*:
* Los registros se muestran en orden descendente por fecha
* El registro más reciente aparece primero
* Orden: 2025-01-15, 2025-01-08, 2025-01-01

*Resultado Obtenido*: ✅ PASS

=== TC-009: Eliminar Registro de Métrica

*Objetivo*: Verificar que se pueden eliminar registros

*Precondiciones*: 
* Usuario autenticado
* Al menos un registro existente

*Pasos*:
. Identificar un registro en la tabla
. Hacer clic en botón "Eliminar"
. Confirmar eliminación (si hay confirmación)

*Resultado Esperado*:
* El registro desaparece de la tabla
* Mensaje de confirmación de eliminación
* El registro se elimina de la base de datos

*Resultado Obtenido*: ✅ PASS

*Observaciones*: La eliminación es inmediata. Se recomienda añadir confirmación visual antes de eliminar.

=== TC-010: Prevención de Eliminación No Autorizada

*Objetivo*: Verificar que un usuario solo puede eliminar sus propios registros

*Precondiciones*: 
* Dos usuarios diferentes registrados
* Cada uno con sus propios registros

*Pasos*:
. Usuario A intenta eliminar registro de Usuario B (manipulando request)
. Verificar respuesta del servidor

*Resultado Esperado*:
* Error: "No tiene permiso para borrar este registro"
* El registro NO se elimina

*Resultado Obtenido*: ✅ PASS

*Nota*: Probado a nivel de API, no desde UI

=== TC-011: Actualizar Perfil de Usuario

*Objetivo*: Verificar que se puede actualizar el perfil

*Precondiciones*: Usuario autenticado

*Pasos*:
. Acceder a "Mi Perfil"
. Modificar nombre: "Juan Carlos"
. Modificar apellidos: "Pérez López"
. Modificar email (a uno no usado): "juan.carlos@example.com"
. Hacer clic en "Actualizar Perfil"

*Resultado Esperado*:
* Mensaje de éxito
* Los datos se actualizan en la base de datos
* El cambio se refleja en la interfaz

*Resultado Obtenido*: ✅ PASS

=== TC-012: Validación de Email Duplicado en Actualización

*Objetivo*: Verificar que no se puede cambiar a un email ya usado por otro usuario

*Precondiciones*: 
* Usuario A autenticado
* Existe Usuario B con email "otro@example.com"

*Pasos*:
. Usuario A intenta cambiar su email a "otro@example.com"
. Hacer clic en "Actualizar Perfil"

*Resultado Esperado*:
* Error: "El email ya está registrado por otro usuario"
* El perfil NO se actualiza

*Resultado Obtenido*: ✅ PASS

=== TC-013: Cambiar Contraseña

*Objetivo*: Verificar que se puede cambiar la contraseña

*Precondiciones*: Usuario autenticado con contraseña conocida

*Pasos*:
. Ir a sección "Cambiar Contraseña"
. Contraseña actual: "Password123!"
. Nueva contraseña: "NewPassword456!"
. Confirmar nueva: "NewPassword456!"
. Hacer clic en "Cambiar Contraseña"

*Resultado Esperado*:
* Mensaje de éxito
* La contraseña se actualiza en BD
* El usuario puede hacer login con la nueva contraseña

*Resultado Obtenido*: ✅ PASS

*Observaciones*: Después de cambiar, se verificó login con la nueva contraseña.

=== TC-014: Validación de Contraseña Actual Incorrecta

*Objetivo*: Verificar que se valida la contraseña actual

*Precondiciones*: Usuario autenticado

*Pasos*:
. Introducir contraseña actual incorrecta
. Introducir nueva contraseña válida
. Intentar cambiar

*Resultado Esperado*:
* Error: "La contraseña anterior es incorrecta"
* La contraseña NO se cambia

*Resultado Obtenido*: ✅ PASS

=== TC-015: Validación de Longitud Mínima de Contraseña

*Objetivo*: Verificar validación de longitud mínima

*Precondiciones*: Usuario autenticado

*Pasos*:
. Contraseña actual correcta
. Nueva contraseña: "123" (< 8 caracteres)
. Intentar cambiar

*Resultado Esperado*:
* Error: "La nueva contraseña debe tener al menos 8 caracteres"
* La contraseña NO se cambia

*Resultado Obtenido*: ✅ PASS

=== TC-016: Validación de Coincidencia de Contraseñas

*Objetivo*: Verificar que las contraseñas nuevas deben coincidir

*Precondiciones*: Usuario autenticado

*Pasos*:
. Nueva contraseña: "Password123!"
. Confirmar nueva: "Password456!" (diferente)
. Intentar cambiar

*Resultado Esperado*:
* Error: "Las nuevas contraseñas no coinciden"
* La contraseña NO se cambia

*Resultado Obtenido*: ✅ PASS

=== TC-017: Cerrar Sesión

*Objetivo*: Verificar que se puede cerrar sesión correctamente

*Precondiciones*: Usuario autenticado

*Pasos*:
. Hacer clic en "Cerrar Sesión" o "Logout"
. Observar redirección

*Resultado Esperado*:
* La sesión se cierra
* Redirección a la página de login
* No se puede acceder al dashboard sin autenticación

*Resultado Obtenido*: ✅ PASS

*Observaciones*: Después de logout, intentar acceder directamente al dashboard redirige a login (buena seguridad).

=== TC-018: Protección de Rutas (Sin Autenticación)

*Objetivo*: Verificar que no se puede acceder a rutas protegidas sin autenticación

*Pasos*:
. Sin estar autenticado, intentar acceder directamente a:
   * dashboard.php
   * profile.php

*Resultado Esperado*:
* Redirección automática a login
* No se muestran datos

*Resultado Obtenido*: ✅ PASS

*Observaciones*: Las sesiones están correctamente implementadas.

=== TC-019: Cálculo Correcto del IMC

*Objetivo*: Verificar que el IMC se calcula correctamente con diferentes valores

*Precondiciones*: Usuario autenticado

*Casos de Prueba*:

[cols="1,1,1,1"]
|===
|Peso (kg) |Altura (m) |IMC Esperado |Resultado

|70.0
|1.75
|22.86
|✅ PASS

|85.5
|1.80
|26.39
|✅ PASS

|60.0
|1.60
|23.44
|✅ PASS

|100.0
|2.00
|25.00
|✅ PASS
|===

*Resultado Obtenido*: ✅ PASS

*Observaciones*: El IMC se calcula correctamente en todos los casos, redondeado a 2 decimales.

=== TC-020: Aislamiento de Datos Entre Usuarios

*Objetivo*: Verificar que cada usuario solo ve sus propios datos

*Precondiciones*: 
* Usuario A con registros
* Usuario B con registros

*Pasos*:
. Login como Usuario A
. Anotar registros visibles
. Logout
. Login como Usuario B
. Verificar registros visibles

*Resultado Esperado*:
* Usuario A solo ve sus propios registros
* Usuario B solo ve sus propios registros
* No hay cross-contamination de datos

*Resultado Obtenido*: ✅ PASS

*Observaciones*: El user_id se maneja correctamente en todas las queries.

== Resumen de Resultados

=== Estadísticas

* *Total de casos de prueba*: 20
* *Casos exitosos (PASS)*: 20
* *Casos fallidos (FAIL)*: 0
* *Casos bloqueados*: 0
* *Tasa de éxito*: 100%

=== Distribución por Categoría

[cols="2,1,1"]
|===
|Categoría |Casos |Estado

|Autenticación y Registro
|5
|✅ 100% PASS

|Gestión de Perfil
|6
|✅ 100% PASS

|Métricas de Salud
|6
|✅ 100% PASS

|Seguridad
|3
|✅ 100% PASS
|===

== Defectos Encontrados

=== Defectos Críticos
*Ninguno*

=== Defectos Mayores
*Ninguno*

=== Defectos Menores

. *Falta de confirmación visual antes de eliminar*
   * *Descripción*: Al eliminar un registro, no hay diálogo de confirmación
   * *Severidad*: Menor
   * *Recomendación*: Añadir un modal de confirmación "¿Está seguro de que desea eliminar este registro?"
   * *Workaround*: Los usuarios deben tener cuidado al hacer clic

. *Sin validación de fechas futuras*
   * *Descripción*: Se pueden registrar métricas con fechas futuras
   * *Severidad*: Menor
   * *Recomendación*: Añadir validación para prevenir fechas futuras
   * *Estado*: Aceptable para el MVP

=== Sugerencias de Mejora (UX)

. *Feedback visual mejorado*
   * Añadir animaciones al añadir/eliminar registros
   * Toast notifications para acciones exitosas

. *Gráficos de evolución*
   * Mostrar gráfico de línea con evolución del peso/IMC
   * Ayudaría a visualizar tendencias

. *Validación en tiempo real*
   * Mostrar errores de validación mientras el usuario escribe
   * Mejoraría la experiencia de usuario

== Pruebas de Compatibilidad

=== Navegadores Probados

[cols="2,1,1,3"]
|===
|Navegador |Versión |Estado |Observaciones

|Google Chrome
|120+
|✅ PASS
|Funciona perfectamente

|Mozilla Firefox
|121+
|✅ PASS
|Funciona perfectamente

|Safari
|17+
|⚠️ NO PROBADO
|Requiere prueba en macOS

|Microsoft Edge
|120+
|✅ PASS
|Funciona perfectamente
|===

=== Dispositivos Probados

[cols="2,1,3"]
|===
|Dispositivo |Estado |Observaciones

|Desktop (1920x1080)
|✅ PASS
|Interfaz óptima

|Laptop (1366x768)
|✅ PASS
|Interfaz correcta

|Tablet (768x1024)
|⚠️ NO PROBADO
|Requiere validación responsive

|Mobile (375x667)
|⚠️ NO PROBADO
|Requiere validación responsive
|===

== Pruebas de Rendimiento

=== Tiempos de Respuesta

[cols="2,1,1,1"]
|===
|Operación |Tiempo Promedio |Objetivo |Estado

|Login
|<500ms
|<2s
|✅ PASS

|Añadir métrica
|<400ms
|<2s
|✅ PASS

|Cargar historial (10 registros)
|<300ms
|<2s
|✅ PASS

|Actualizar perfil
|<500ms
|<2s
|✅ PASS
|===

*Observaciones*: 
* Todos los tiempos están muy por debajo del objetivo
* La aplicación es rápida y responsive
* No se observan problemas de rendimiento

=== Pruebas de Carga

*Estado*: ⚠️ NO REALIZADAS

*Recomendación*: Para producción, realizar pruebas con herramientas como:
* Apache JMeter
* Locust
* k6

== Pruebas de Seguridad

=== Pruebas Realizadas

. ✅ *SQL Injection*
   * Intentado en campos de login y registro
   * Resultado: Protegido (prepared statements)

. ✅ *Acceso no autorizado a datos*
   * Intentado acceder a registros de otros usuarios
   * Resultado: Correctamente bloqueado

. ✅ *Session Hijacking básico*
   * Intentado acceder sin sesión válida
   * Resultado: Correctamente manejado

. ⚠️ *XSS (Cross-Site Scripting)*
   * Estado: NO PROBADO formalmente
   * Recomendación: Validar sanitización de outputs

. ⚠️ *CSRF (Cross-Site Request Forgery)*
   * Estado: NO IMPLEMENTADO
   * Recomendación: Implementar tokens CSRF para producción

== Automatización de Pruebas

=== Herramientas Recomendadas

==== Playwright (Recomendado)

Playwright es una herramienta moderna para pruebas E2E:

[source,javascript]
----
// Ejemplo de test automatizado con Playwright
const { test, expect } = require('@playwright/test');

test('Login exitoso', async ({ page }) => {
  await page.goto('http://localhost/index.php');
  await page.fill('#email', 'test@example.com');
  await page.fill('#password', 'password123');
  await page.click('button[type="submit"]');
  await expect(page).toHaveURL(/dashboard/);
});

test('Añadir métrica de salud', async ({ page }) => {
  // ... código de login ...
  await page.fill('#peso', '75.5');
  await page.fill('#altura', '1.75');
  await page.fill('#fecha', '2025-01-15');
  await page.click('#btn-add-data');
  await expect(page.locator('.success-message')).toBeVisible();
});
----

==== Selenium

Alternativa más establecida:

[source,python]
----
# Ejemplo con Selenium (Python)
from selenium import webdriver
from selenium.webdriver.common.by import By

driver = webdriver.Chrome()
driver.get("http://localhost/index.php")

# Login
driver.find_element(By.ID, "email").send_keys("test@example.com")
driver.find_element(By.ID, "password").send_keys("password123")
driver.find_element(By.CSS_SELECTOR, "button[type='submit']").click()

# Verificar redirección
assert "dashboard" in driver.current_url

driver.quit()
----

=== Plan de Automatización

*Fase 1* (Prioritario):
* Flujo de registro y login
* Añadir y eliminar métricas
* Cambio de contraseña

*Fase 2* (Deseable):
* Validaciones de formularios
* Mensajes de error
* Actualización de perfil

*Fase 3* (Opcional):
* Tests de rendimiento
* Tests de seguridad
* Tests de compatibilidad cross-browser

== Recomendaciones

=== Inmediatas (Alta Prioridad)

. ✅ Implementar confirmación antes de eliminar registros
. ✅ Añadir validación de fechas futuras
. ⚠️ Probar en dispositivos móviles/tablets
. ⚠️ Probar en Safari

=== Corto Plazo

. Implementar suite de tests E2E con Playwright
. Añadir tests de seguridad XSS/CSRF
. Mejorar feedback visual (toast notifications)
. Implementar recuperación de contraseña

=== Largo Plazo

. Implementar gráficos de evolución
. Añadir exportación de datos (PDF/CSV)
. Implementar pruebas de carga
. Añadir sistema de logging para auditoría

== Conclusiones

=== Resumen General

El sistema StatTracker ha pasado satisfactoriamente todas las pruebas de sistema realizadas. La aplicación:

* ✓ Cumple con todos los requisitos funcionales especificados
* ✓ Mantiene la integridad de datos
* ✓ Implementa seguridad básica adecuada
* ✓ Proporciona una experiencia de usuario fluida
* ✓ Tiene rendimiento excelente

=== Preparación para Producción

*Estado actual*: ✅ **APTO PARA PRODUCCIÓN** (con recomendaciones)

El sistema está listo para despliegue con las siguientes consideraciones:

. Implementar las mejoras de seguridad recomendadas (CSRF tokens)
. Añadir confirmación de eliminación
. Realizar pruebas en dispositivos móviles
. Configurar monitoreo y logging en producción
. Implementar backups automáticos de base de datos

=== Calidad General

[.lead]
*Calificación*: ⭐⭐⭐⭐⭐ (9/10)

El proyecto demuestra:
* Excelente funcionalidad core
* Buena seguridad básica
* Código bien estructurado
* Validaciones robustas
* Rendimiento óptimo

== Anexos

=== Anexo A: Checklist de Pruebas Manuales

```
☐ Registro de usuario nuevo
☐ Validación de email duplicado
☐ Validación de formato de email
☐ Login exitoso
☐ Login con credenciales incorrectas
☐ Añadir métrica de salud
☐ Validación de altura cero
☐ Visualizar historial
☐ Eliminar registro
☐ Actualizar perfil
☐ Validación email duplicado en perfil
☐ Cambiar contraseña
☐ Validación contraseña actual
☐ Validación longitud contraseña
☐ Validación coincidencia contraseñas
☐ Cerrar sesión
☐ Protección de rutas
☐ Cálculo correcto IMC
☐ Aislamiento de datos entre usuarios
```

=== Anexo B: Scripts de Testing

Carpeta recomendada: `tests/system/`

Estructura sugerida:
```
tests/system/
├── playwright.config.js
├── auth.spec.js
├── metrics.spec.js
├── profile.spec.js
└── README.md
```

=== Anexo C: Datos de Prueba Utilizados

*Usuarios de Prueba*:
* Usuario A: test@example.com / password123
* Usuario B: second@example.com / password456

*Métricas de Prueba*:
* Peso: 70-100 kg
* Altura: 1.60-2.00 m
* Fechas: 2025-01-01 a 2025-01-15

---

_Este informe fue generado como parte de la práctica de Pruebas y Puesta en Producción Segura. Los tests deben repetirse antes de cada despliegue a producción._
